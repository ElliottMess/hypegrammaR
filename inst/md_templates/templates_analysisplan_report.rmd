---
title: "analysisplan_report"
author: ""
date: "4 February 2019"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(htmltools)
library(hypegrammaR)


```

```{r}

print(x$results[[1]] %>% map_to_visualisation)
```

```{r,include=T,warning=F,error=F,message=F,echo=TRUE}
resultlist<-x
analysisplan<-resultlist$analysisplan
knitr::kable(analysisplan,format = "html")
results<-resultlist$results
if(!is.null(questionnaire)){
  results<-lapply(results,map_to_labeled,questionnaire=questionnaire)
}
for(rq in unique(analysisplan$research.question)){
  htmltools::h1(rq) %>% as.character %>% cat
  in_rq<-(analysisplan$research.question==rq)
  for(srq in unique(analysisplan$sub.research.question)){
    in_srq<-(analysisplan$sub.research.question==srq)
    htmltools::h2(srq) %>% as.character %>% cat
    
    for(i in which(in_rq & in_srq)){
    print(x$results[[1]] %>% map_to_visualisation %>% .$ggplot)
    print(results[[i]] %>% map_to_visualisation_heatmap %>% .$ggplot)
    kable(resultlist$results[[i]]$hypothesis.test %>% as.data.frame,format="html")    }
    
  }
  
}


```

## R Markdown


This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
